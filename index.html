<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        .tooltip {
            position: relative;
            cursor: pointer;
        }

        .tooltip-content {
            display: none;
            position: absolute;
            background: #333;
            color: #fff;
            padding: 5px;
            border-radius: 5px;
            white-space: pre-wrap;
            z-index: 1000;
        }
    </style>
    <script src="https://cdn.jsdelivr.net/npm/@floating-ui/dom@1.6.8"></script>
</head>

<body>
    <section>
        <h1>Important Text</h1>
        <p>This is information <cite data-style="Chicago">@jones2024</cite></p>
        <p>This is more information <cite data-style="Chicago">@smith2021,@johnson1999</cite></p>
    </section>

    <a href="https://chatgpt.com/share/8b3aa6bf-086a-4d0a-a196-d648b136198f">help from chatgpt</a>

    <script>
        const {computePosition, offset, flip, shift} = window.FloatingUIDOM;

        function getCitation(citation_id, type, style, format) {
            // Simulate fetching a citation based on the id
            // In a real scenario, this function would query a citation database or API
            if (type === "inline") {
                return `<span>${citation_id} (inline citation in ${style})</span>`;
            } else if (type === "bibliography") {
                return `<li>${citation_id} (bibliography entry in ${style})</li>`;
            }
            return "";
        }

        function formatCitations() {
            // Find all <cite> elements in the document
            const citeElements = document.querySelectorAll('cite[data-style]');

            citeElements.forEach(el => {
                const dataStyle = el.getAttribute('data-style');
                const citation_ids = el.innerText.replace(/@/g, '').split(',').map(id => id.trim());

                // Create inline citation HTML
                const inlineCitations = citation_ids.map(id => getCitation(id, "inline", dataStyle, "html")).join(', ');

                // Create bibliography list for tooltip
                const bibliographyList = citation_ids.map(id => getCitation(id, "bibliography", dataStyle, "html")).join('');

                // Replace innerHTML with inline citations
                el.innerHTML = inlineCitations;

                // Create tooltip content
                const tooltipContent = document.createElement('div');
                tooltipContent.classList.add('tooltip-content');
                tooltipContent.innerHTML = `<ul>${bibliographyList}</ul>`;

                // Append tooltip content to the cite element
                el.appendChild(tooltipContent);
                el.classList.add('tooltip');

                // Use Floating UI to manage tooltip position
                el.addEventListener('mouseenter', () => {
                    tooltipContent.style.display = 'block';
                    computePosition(el, tooltipContent, {
                        placement: 'top',
                        middleware: [
                            offset(10),
                            flip(),
                            shift({padding: 5})
                        ],
                    }).then(({x, y}) => {
                        Object.assign(tooltipContent.style, {
                            left: `${x}px`,
                            top: `${y}px`
                        });
                    });
                });

                el.addEventListener('mouseleave', () => {
                    tooltipContent.style.display = 'none';
                });
            });
        }

        // Execute the function after the DOM is fully loaded
        document.addEventListener('DOMContentLoaded', formatCitations);
    </script>
</body>

</html>